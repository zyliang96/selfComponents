# 4 月 20 日题目

## 一、节流和防抖分别是什么？在什么场景下使用？请分别实现一个节流函数和一个防抖函数

防抖（debounce）就是在事件触发后的 n 秒之后，再去执行真正需要执行的函数，如果在这 n 秒之内事件又被触发，则重新开始计时。防抖函数实现如下：

```js
const debounce = (fn, delay = 500) => {
	let timer;
	return function (...args) {
		clearTimeout(timer); //清空定时器
		timer = setTimeout(function () {
			fn.apply(this, args); //改变this指向
		}, delay); //延迟一定时间执行
	};
};
```

截流（throttle）就是规定好一个单位时间，触发函数一次。如果在这个单位时间内触发多次函数的话，只有一次是可被执行的。想执行多次的话，只能等到下一个周期里。实现代码如下：

```js
// 定时器版本
const trottle1 = (fn, delay = 500) => {
	let timer;
	return (...args) => {
		if (!timer) {
			timer = setTimeout(() => {
				timer = null;
				fn.apply(this, args);
			}, delay);
		}
	};
};
// 时间戳版本
const trottle2 = (fn, delay = 500) => {
	let oldTime = Date.now();
	return function (...args) {
		const nowTime = Date.now();
		if (nowTime - oldTime >= delay) {
			oldTime = Date.now();
			fn.apply(this, args);
		}
	};
};
```

实际运用中比如，按键快频率重复触发，拖拽场景、表单验证场景 resize ，scroll、onmosemove 等等触发事件。 性能优化相关。

## 二、怎么禁止让 js 读取 cookie？怎么让 cookie 只在 HTTPS 下传输？

由于 cookie 会存放在客户端，一般情况下会保存一些凭证及状态信息，为了防止 cookie 泄露造成安全问题。可以这只 cookie 的 HttpOnly 属性，那么通过程序(JS 脚本、Applet 等)将无法读取到 Cookie 信息，这样能有效的防止 XSS 攻击。cookie 中有个属性 secure，当该属性设置为 true 时，表示创建的 Cookie 会被以安全的形式向服务器传输，也就是只能在 HTTPS 连接中被浏览器传递到服务器端进行会话验证，如果是 HTTP 连接则不会传递该 cookie 信息，所以不会被窃取到 Cookie 的具体内容。就是只允许在加密的情况下将 cookie 加在数据包请求头部，防止 cookie 被带出来。secure 属性是防止信息在传递的过程中被监听捕获后信息泄漏。但是这两个属性并不能解决 cookie 在本机出现的信息泄漏的问题。

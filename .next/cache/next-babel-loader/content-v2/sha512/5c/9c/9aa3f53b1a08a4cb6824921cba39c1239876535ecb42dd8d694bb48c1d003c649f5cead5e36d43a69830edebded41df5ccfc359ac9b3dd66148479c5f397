{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault2 = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault2(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.initScriptLoader = initScriptLoader;\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutPropertiesLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutPropertiesLoose\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _headManagerContext = require(\"../next-server/lib/head-manager-context\");\n\nvar _headManager = require(\"./head-manager\");\n\nvar _requestIdleCallback = require(\"./request-idle-callback\");\n\nvar ScriptCache = new Map();\nvar LoadCache = new Set();\nvar ignoreProps = ['onLoad', 'dangerouslySetInnerHTML', 'children', 'onError', 'strategy', 'preload'];\n\nvar loadScript = function loadScript(props) {\n  var src = props.src,\n      id = props.id,\n      _props$onLoad = props.onLoad,\n      onLoad = _props$onLoad === void 0 ? function () {} : _props$onLoad,\n      dangerouslySetInnerHTML = props.dangerouslySetInnerHTML,\n      _props$children = props.children,\n      children = _props$children === void 0 ? '' : _props$children,\n      onError = props.onError;\n  var cacheKey = id || src;\n\n  if (ScriptCache.has(src)) {\n    if (!LoadCache.has(cacheKey)) {\n      LoadCache.add(cacheKey); // Execute onLoad since the script loading has begun\n\n      ScriptCache.get(src).then(onLoad, onError);\n    }\n\n    return;\n  }\n\n  var el = document.createElement('script');\n  var loadPromise = new Promise(function (resolve, reject) {\n    el.addEventListener('load', function () {\n      resolve();\n\n      if (onLoad) {\n        onLoad.call(this);\n      }\n    });\n    el.addEventListener('error', function () {\n      reject();\n\n      if (onError) {\n        onError();\n      }\n    });\n  });\n\n  if (src) {\n    ScriptCache.set(src, loadPromise);\n    LoadCache.add(cacheKey);\n  }\n\n  if (dangerouslySetInnerHTML) {\n    el.innerHTML = dangerouslySetInnerHTML.__html || '';\n  } else if (children) {\n    el.textContent = typeof children === 'string' ? children : Array.isArray(children) ? children.join('') : '';\n  } else if (src) {\n    el.src = src;\n  }\n\n  for (var _i = 0, _Object$entries = Object.entries(props); _i < _Object$entries.length; _i++) {\n    var _Object$entries$_i = (0, _slicedToArray2[\"default\"])(_Object$entries[_i], 2),\n        k = _Object$entries$_i[0],\n        value = _Object$entries$_i[1];\n\n    if (value === undefined || ignoreProps.includes(k)) {\n      continue;\n    }\n\n    var attr = _headManager.DOMAttributeNames[k] || k.toLowerCase();\n    el.setAttribute(attr, value);\n  }\n\n  document.body.appendChild(el);\n};\n\nfunction handleClientScriptLoad(props) {\n  var _props$strategy = props.strategy,\n      strategy = _props$strategy === void 0 ? 'defer' : _props$strategy;\n\n  if (strategy === 'defer') {\n    loadScript(props);\n  } else if (strategy === 'lazy') {\n    window.addEventListener('load', function () {\n      (0, _requestIdleCallback.requestIdleCallback)(function () {\n        return loadScript(props);\n      });\n    });\n  }\n}\n\nfunction loadLazyScript(props) {\n  if (document.readyState === 'complete') {\n    (0, _requestIdleCallback.requestIdleCallback)(function () {\n      return loadScript(props);\n    });\n  } else {\n    window.addEventListener('load', function () {\n      (0, _requestIdleCallback.requestIdleCallback)(function () {\n        return loadScript(props);\n      });\n    });\n  }\n}\n\nfunction initScriptLoader(scriptLoaderItems) {\n  scriptLoaderItems.forEach(handleClientScriptLoad);\n}\n\nfunction Script(props) {\n  var _props$src = props.src,\n      src = _props$src === void 0 ? '' : _props$src,\n      _props$onLoad2 = props.onLoad,\n      onLoad = _props$onLoad2 === void 0 ? function () {} : _props$onLoad2,\n      dangerouslySetInnerHTML = props.dangerouslySetInnerHTML,\n      _props$children2 = props.children,\n      children = _props$children2 === void 0 ? '' : _props$children2,\n      _props$strategy2 = props.strategy,\n      strategy = _props$strategy2 === void 0 ? 'defer' : _props$strategy2,\n      onError = props.onError,\n      _props$preload = props.preload,\n      preload = _props$preload === void 0 ? false : _props$preload,\n      restProps = (0, _objectWithoutPropertiesLoose2[\"default\"])(props, [\"src\", \"onLoad\", \"dangerouslySetInnerHTML\", \"children\", \"strategy\", \"onError\", \"preload\"]); // Context is available only during SSR\n\n  var _ref = (0, _react.useContext)(_headManagerContext.HeadManagerContext),\n      updateScripts = _ref.updateScripts,\n      scripts = _ref.scripts;\n\n  (0, _react.useEffect)(function () {\n    if (strategy === 'defer') {\n      loadScript(props);\n    } else if (strategy === 'lazy') {\n      loadLazyScript(props);\n    }\n  }, [props, strategy]);\n\n  if (!process.env.__NEXT_SCRIPT_LOADER) {\n    return null;\n  }\n\n  if (strategy === 'dangerouslyBlockRendering') {\n    var syncProps = (0, _extends2[\"default\"])({}, restProps);\n\n    for (var _i2 = 0, _Object$entries2 = Object.entries({\n      src: src,\n      onLoad: onLoad,\n      onError: onError,\n      dangerouslySetInnerHTML: dangerouslySetInnerHTML,\n      children: children\n    }); _i2 < _Object$entries2.length; _i2++) {\n      var _Object$entries2$_i = (0, _slicedToArray2[\"default\"])(_Object$entries2[_i2], 2),\n          k = _Object$entries2$_i[0],\n          value = _Object$entries2$_i[1];\n\n      if (!value) {\n        continue;\n      }\n\n      if (k === 'children') {\n        syncProps.dangerouslySetInnerHTML = {\n          __html: typeof value === 'string' ? value : Array.isArray(value) ? value.join('') : ''\n        };\n      } else {\n        ;\n        syncProps[k] = value;\n      }\n    }\n\n    return /*#__PURE__*/_react[\"default\"].createElement(\"script\", syncProps);\n  } else if (strategy === 'defer') {\n    if (updateScripts && preload) {\n      scripts.defer = (scripts.defer || []).concat([src]);\n      updateScripts(scripts);\n    }\n  } else if (strategy === 'eager') {\n    if (updateScripts) {\n      scripts.eager = (scripts.eager || []).concat([(0, _extends2[\"default\"])({\n        src: src,\n        onLoad: onLoad,\n        onError: onError\n      }, restProps)]);\n      updateScripts(scripts);\n    }\n  }\n\n  return null;\n}\n\nvar _default = Script;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["../../client/experimental-script.tsx"],"names":["ScriptCache","LoadCache","ignoreProps","loadScript","props","onLoad","children","cacheKey","id","el","document","loadPromise","resolve","reject","onError","dangerouslySetInnerHTML","Array","Object","value","attr","DOMAttributeNames","k","strategy","window","scriptLoaderItems","src","preload","HeadManagerContext","loadLazyScript","process","syncProps","__html","updateScripts","scripts","Script"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext } from 'react'\nimport { ScriptHTMLAttributes } from 'react'\nimport { HeadManagerContext } from '../next-server/lib/head-manager-context'\nimport { DOMAttributeNames } from './head-manager'\nimport { requestIdleCallback } from './request-idle-callback'\n\nconst ScriptCache = new Map()\nconst LoadCache = new Set()\n\nexport interface Props extends ScriptHTMLAttributes<HTMLScriptElement> {\n  strategy?: 'defer' | 'lazy' | 'dangerouslyBlockRendering' | 'eager'\n  id?: string\n  onLoad?: () => void\n  onError?: () => void\n  children?: React.ReactNode\n  preload?: boolean\n}\n\nconst ignoreProps = [\n  'onLoad',\n  'dangerouslySetInnerHTML',\n  'children',\n  'onError',\n  'strategy',\n  'preload',\n]\n\nconst loadScript = (props: Props): void => {\n  const {\n    src,\n    id,\n    onLoad = () => {},\n    dangerouslySetInnerHTML,\n    children = '',\n    onError,\n  } = props\n\n  const cacheKey = id || src\n  if (ScriptCache.has(src)) {\n    if (!LoadCache.has(cacheKey)) {\n      LoadCache.add(cacheKey)\n      // Execute onLoad since the script loading has begun\n      ScriptCache.get(src).then(onLoad, onError)\n    }\n    return\n  }\n\n  const el = document.createElement('script')\n\n  const loadPromise = new Promise((resolve, reject) => {\n    el.addEventListener('load', function () {\n      resolve()\n      if (onLoad) {\n        onLoad.call(this)\n      }\n    })\n    el.addEventListener('error', function () {\n      reject()\n      if (onError) {\n        onError()\n      }\n    })\n  })\n\n  if (src) {\n    ScriptCache.set(src, loadPromise)\n    LoadCache.add(cacheKey)\n  }\n\n  if (dangerouslySetInnerHTML) {\n    el.innerHTML = dangerouslySetInnerHTML.__html || ''\n  } else if (children) {\n    el.textContent =\n      typeof children === 'string'\n        ? children\n        : Array.isArray(children)\n        ? children.join('')\n        : ''\n  } else if (src) {\n    el.src = src\n  }\n\n  for (const [k, value] of Object.entries(props)) {\n    if (value === undefined || ignoreProps.includes(k)) {\n      continue\n    }\n\n    const attr = DOMAttributeNames[k] || k.toLowerCase()\n    el.setAttribute(attr, value)\n  }\n\n  document.body.appendChild(el)\n}\n\nfunction handleClientScriptLoad(props: Props) {\n  const { strategy = 'defer' } = props\n  if (strategy === 'defer') {\n    loadScript(props)\n  } else if (strategy === 'lazy') {\n    window.addEventListener('load', () => {\n      requestIdleCallback(() => loadScript(props))\n    })\n  }\n}\n\nfunction loadLazyScript(props: Props) {\n  if (document.readyState === 'complete') {\n    requestIdleCallback(() => loadScript(props))\n  } else {\n    window.addEventListener('load', () => {\n      requestIdleCallback(() => loadScript(props))\n    })\n  }\n}\n\nexport function initScriptLoader(scriptLoaderItems: Props[]) {\n  scriptLoaderItems.forEach(handleClientScriptLoad)\n}\n\nfunction Script(props: Props): JSX.Element | null {\n  const {\n    src = '',\n    onLoad = () => {},\n    dangerouslySetInnerHTML,\n    children = '',\n    strategy = 'defer',\n    onError,\n    preload = false,\n    ...restProps\n  } = props\n\n  // Context is available only during SSR\n  const { updateScripts, scripts } = useContext(HeadManagerContext)\n\n  useEffect(() => {\n    if (strategy === 'defer') {\n      loadScript(props)\n    } else if (strategy === 'lazy') {\n      loadLazyScript(props)\n    }\n  }, [props, strategy])\n\n  if (!process.env.__NEXT_SCRIPT_LOADER) {\n    return null\n  }\n\n  if (strategy === 'dangerouslyBlockRendering') {\n    const syncProps: Props = { ...restProps }\n\n    for (const [k, value] of Object.entries({\n      src,\n      onLoad,\n      onError,\n      dangerouslySetInnerHTML,\n      children,\n    })) {\n      if (!value) {\n        continue\n      }\n      if (k === 'children') {\n        syncProps.dangerouslySetInnerHTML = {\n          __html:\n            typeof value === 'string'\n              ? value\n              : Array.isArray(value)\n              ? value.join('')\n              : '',\n        }\n      } else {\n        ;(syncProps as any)[k] = value\n      }\n    }\n\n    return <script {...syncProps} />\n  } else if (strategy === 'defer') {\n    if (updateScripts && preload) {\n      scripts.defer = (scripts.defer || []).concat([src])\n      updateScripts(scripts)\n    }\n  } else if (strategy === 'eager') {\n    if (updateScripts) {\n      scripts.eager = (scripts.eager || []).concat([\n        {\n          src,\n          onLoad,\n          onError,\n          ...restProps,\n        },\n      ])\n      updateScripts(scripts)\n    }\n  }\n\n  return null\n}\n\nexport default Script\n"]},"metadata":{},"sourceType":"script"}
{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, Suspense } from \"react\";\nimport Header from \"./components/header\";\nimport pageConfig from \"./pageConfig\";\nimport { matchPath } from \"./utils/router.js\";\nimport { useRouter } from \"next/router\"; // 增加前缀/\n\nfunction addLeadingSlash(path) {\n  return path.charAt(0) === \"/\" ? path : \"/\" + path;\n}\n\nfunction Page(props) {\n  var children = props.children;\n  var router = useRouter();\n\n  var _useState = useState(function () {\n    var match = null;\n    var key = null;\n    var locationPathName = window.location.pathname;\n    pageConfig.forEach(function (item) {\n      if (match == null) {\n        var path = addLeadingSlash(item.path);\n        match = matchPath(locationPathName, {\n          path: path\n        });\n\n        if (match) {\n          key = item.key;\n        }\n      }\n    });\n    return key || pageConfig[0].key || null;\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      currentPage = _useState2[0],\n      setCurrentPage = _useState2[1]; // 当前页面\n\n  /**\r\n   * 头部点击\r\n   */\n\n\n  var headerTabOnChange = function headerTabOnChange(key) {\n    setCurrentPage(key);\n  };\n\n  useEffect(function () {\n    if (currentPage && Array.isArray(pageConfig)) {\n      var len = pageConfig.length;\n\n      for (var i = 0; i < len; i++) {\n        var item = pageConfig[i];\n\n        if (currentPage === item.key) {\n          router.push(item.path);\n        }\n      }\n    }\n  }, [currentPage]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"site-page-box\"\n  }, /*#__PURE__*/React.createElement(Header, {\n    list: pageConfig,\n    onChange: headerTabOnChange,\n    value: currentPage\n  }), /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(React.Fragment, null)\n  }, children));\n}\n\nexport default Page;","map":{"version":3,"sources":["D:/self/develop/selfComponents/src/page.tsx"],"names":["path","children","props","router","useRouter","currentPage","setCurrentPage","useState","match","key","locationPathName","window","pageConfig","addLeadingSlash","item","matchPath","headerTabOnChange","useEffect","Array","len","i"],"mappings":";AAAA,OAAA,KAAA,IAAA,SAAA,EAAA,QAAA,EAAA,QAAA,QAAA,OAAA;AACA,OAAA,MAAA,MAAA,qBAAA;AACA,OAAA,UAAA,MAAA,cAAA;AACA,SAAA,SAAA,QAAA,mBAAA;AACA,SAAA,SAAA,QAAA,aAAA,C,CACA;;AACA,SAAA,eAAA,CAAA,IAAA,EAA+B;AAC3B,SAAOA,IAAI,CAAJA,MAAAA,CAAAA,CAAAA,MAAAA,GAAAA,GAAAA,IAAAA,GAAgC,MAAvC,IAAA;AACH;;AACD,SAAA,IAAA,CAAA,KAAA,EAAqB;AAAA,MACTC,QADS,GACIC,KADJ,CAAA,QAAA;AAEjB,MAAMC,MAAM,GAAGC,SAAf,EAAA;;AAFiB,MAAA,SAAA,GAGqBG,QAAQ,CAAC,YAAM;AACjD,QAAIC,KAAK,GAAT,IAAA;AACA,QAAIC,GAAG,GAAP,IAAA;AACA,QAAMC,gBAAgB,GAAGC,MAAM,CAANA,QAAAA,CAAzB,QAAA;AACAC,IAAAA,UAAU,CAAVA,OAAAA,CAAmB,UAAA,IAAA,EAAU;AACzB,UAAIJ,KAAK,IAAT,IAAA,EAAmB;AACf,YAAMR,IAAI,GAAGa,eAAe,CAACC,IAAI,CAAjC,IAA4B,CAA5B;AACAN,QAAAA,KAAK,GAAGO,SAAS,CAAA,gBAAA,EAAmB;AAAEf,UAAAA,IAAI,EAAJA;AAAF,SAAnB,CAAjBQ;;AAEA,YAAA,KAAA,EAAW;AACPC,UAAAA,GAAG,GAAGK,IAAI,CAAVL,GAAAA;AACH;AACJ;AARLG,KAAAA;AAUA,WAAOH,GAAG,IAAIG,UAAU,CAAVA,CAAU,CAAVA,CAAPH,GAAAA,IAAP,IAAA;AAjBa,GAG6B,CAH7B;AAAA,MAAA,UAAA,GAAA,cAAA,CAAA,SAAA,EAAA,CAAA,CAAA;AAAA,MAGVJ,WAHU,GAAA,UAAA,CAAA,CAAA,CAAA;AAAA,MAGGC,cAHH,GAAA,UAAA,CAAA,CAAA,CAAA,CAAA,CAkBb;;AACJ;AACJ;AACA;;;AACI,MAAMU,iBAAiB,GAAG,SAApBA,iBAAoB,CAAA,GAAA,EAAS;AAC/BV,IAAAA,cAAc,CAAdA,GAAc,CAAdA;AADJ,GAAA;;AAIAW,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAIZ,WAAW,IAAIa,KAAK,CAALA,OAAAA,CAAnB,UAAmBA,CAAnB,EAA8C;AAC1C,UAAMC,GAAG,GAAGP,UAAU,CAAtB,MAAA;;AACA,WAAK,IAAIQ,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAjB,GAAA,EAAyBA,CAAzB,EAAA,EAA8B;AAC1B,YAAMN,IAAI,GAAGF,UAAU,CAAvB,CAAuB,CAAvB;;AACA,YAAIP,WAAW,KAAKS,IAAI,CAAxB,GAAA,EAA8B;AAC1BX,UAAAA,MAAM,CAANA,IAAAA,CAAYW,IAAI,CAAhBX,IAAAA;AACH;AACJ;AACJ;AATI,GAAA,EAUN,CAVHc,WAUG,CAVM,CAATA;AAYA,SAAA,aACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,SAAS,EAAC;AAAf,GAAA,EAAA,aACI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AACI,IAAA,IAAI,EADR,UAAA;AAEI,IAAA,QAAQ,EAFZ,iBAAA;AAGI,IAAA,KAAK,EAAEZ;AAHX,GAAA,CADJ,EAAA,aAMI,KAAA,CAAA,aAAA,CAAA,QAAA,EAAA;AAAU,IAAA,QAAQ,EAAA,aAAE,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA;AAApB,GAAA,EAPR,QAOQ,CANJ,CADJ;AAUH;;AAED,eAAA,IAAA","sourcesContent":["import React, { useEffect, useRef, useState, lazy, Suspense } from \"react\";\r\nimport Header from \"./components/header\";\r\nimport pageConfig from \"./pageConfig\";\r\nimport { matchPath } from \"./utils/router.js\";\r\nimport { useRouter } from \"next/router\";\r\n// 增加前缀/\r\nfunction addLeadingSlash(path) {\r\n    return path.charAt(0) === \"/\" ? path : \"/\" + path;\r\n}\r\nfunction Page(props) {\r\n    const { children } = props;\r\n    const router = useRouter();\r\n    const [currentPage, setCurrentPage] = useState(() => {\r\n        let match = null;\r\n        let key = null;\r\n        const locationPathName = window.location.pathname;\r\n        pageConfig.forEach((item) => {\r\n            if (match == null) {\r\n                const path = addLeadingSlash(item.path);\r\n                match = matchPath(locationPathName, { path });\r\n\r\n                if (match) {\r\n                    key = item.key;\r\n                }\r\n            }\r\n        });\r\n        return key || pageConfig[0].key || null;\r\n    }); // 当前页面\r\n    /**\r\n     * 头部点击\r\n     */\r\n    const headerTabOnChange = (key) => {\r\n        setCurrentPage(key);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (currentPage && Array.isArray(pageConfig)) {\r\n            const len = pageConfig.length;\r\n            for (let i = 0; i < len; i++) {\r\n                const item = pageConfig[i];\r\n                if (currentPage === item.key) {\r\n                    router.push(item.path);\r\n                }\r\n            }\r\n        }\r\n    }, [currentPage]);\r\n\r\n    return (\r\n        <div className=\"site-page-box\">\r\n            <Header\r\n                list={pageConfig}\r\n                onChange={headerTabOnChange}\r\n                value={currentPage}\r\n            />\r\n            <Suspense fallback={<></>}>{children}</Suspense>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Page;\r\n"]},"metadata":{},"sourceType":"module"}